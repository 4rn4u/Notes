# Simple Network Management Protocol (SNMP)

The Simple Network Management Protocol (SNMP) was developed to monitor and manage network devices. It can also handle configuration tasks and make remote settings. SNMP-enabled hardware includes routers, switches, servers, IoT devices, and other devices that can be queried and controlled using this standard protocol. SNMPv3 is the current version, offering increased security but also greater complexity.

## SNMP Functionality

SNMP facilitates the exchange of information and control commands using agents over UDP port 161. Clients can set specific values, change options, and settings. Unlike traditional client-server communication where the client actively requests information, SNMP also supports traps over UDP port 162. These traps are unsolicited data packets sent from the SNMP server to the client when specific events occur.

For SNMP to function correctly, both the client and server must use unique addresses for SNMP objects, ensuring successful data transmission and network monitoring.

## Management Information Base (MIB)

To ensure compatibility across different manufacturers and client-server combinations, the Management Information Base (MIB) was created. MIB is an independent format for storing device information, listed in a standardized tree hierarchy. Each MIB file contains at least one Object Identifier (OID), providing a unique address, name, type, access rights, and description of each object. MIB files are written in ASCII text format using Abstract Syntax Notation One (ASN.1). They do not contain data but describe where to find specific information and its format.

## Object Identifier (OID)

An OID represents a node in a hierarchical namespace, uniquely identified by a sequence of numbers. This sequence determines the node's position in the tree. OIDs are usually formatted using dot notation and consist of integers. Many nodes contain references to those below them, creating a structured hierarchy. MIBs and their associated OIDs can be looked up in the Object Identifier Registry.

## SNMP Versions

### SNMPv1
SNMP version 1 (SNMPv1) is the original version used for network management and monitoring. It supports information retrieval, device configuration, and event notifications (traps). However, SNMPv1 lacks built-in authentication and encryption, meaning data is sent in plain text and can be easily intercepted.

### SNMPv2
SNMPv2, specifically version v2c, is an extension of SNMPv1. It includes additional functions but maintains similar security levels, with the community string transmitted in plain text, offering no encryption.

### SNMPv3
SNMPv3 significantly enhances security with features like authentication (using a username and password) and data encryption (via a pre-shared key). However, this version is more complex and requires more configuration.

## Community Strings

Community strings function as passwords, determining access to requested information. Many organizations still use SNMPv2 due to the complexity of transitioning to SNMPv3, although this raises security concerns. The lack of encryption means that community strings sent over the network can be intercepted and read, posing a significant risk.

Overall, while SNMP provides robust capabilities for network management and monitoring, the transition to more secure versions like SNMPv3 is critical to mitigate risks associated with unencrypted data transmission.

# SNMP Enumeration Notes

## 📘 Overview

SNMP (Simple Network Management Protocol) allows the collection and organization of network information via a hierarchical structure called the **MIB Tree** (Management Information Base). Each data point in the MIB is defined by an **OID** (Object Identifier).

Useful for:
- Enumerating system info (processes, users, software)
- Scanning exposed services
- Identifying weak configurations
- Building social engineering or attack vectors

---

## 🌲 Common Windows SNMP MIB OIDs

| OID | Description |
|-----|-------------|
| `1.3.6.1.2.1.25.1.6.0` | System Processes |
| `1.3.6.1.2.1.25.4.2.1.2` | Running Programs |
| `1.3.6.1.2.1.25.4.2.1.4` | Process Path |
| `1.3.6.1.2.1.25.2.3.1.4` | Storage Units |
| `1.3.6.1.2.1.25.6.3.1.2` | Installed Software |
| `1.3.6.1.4.1.77.1.2.25` | User Accounts |
| `1.3.6.1.2.1.6.13.1.3` | Listening TCP Ports |

---

## 🔍 Discover SNMP Services

### Scan with `nmap`
```bash
sudo nmap -sU --open -p 161 10.10.10.1-254 -oG open-snmp.txt
````

- `-sU`: UDP scan
    
- `--open`: Show only open ports
    
- `-p 161`: SNMP port
    
- `-oG`: Greppable output
    

---

## 🔓 Brute Force Community Strings with `onesixtyone`

### Create required files

```bash
echo public > community
echo private >> community
echo manager >> community

for ip in $(seq 1 254); do echo 10.10.10.$ip; done > ips
```

### Run scan

```bash
onesixtyone -c community -i ips
```

- Reveals system info if community string is valid
    

---

## 🧵 Enumerate MIB Data with `snmpwalk`

> General syntax:

```bash
snmpwalk -c <community> -v1 <target-ip> <OID>
```

### Enumerate Full MIB Tree

```bash
snmpwalk -c public -v1 -t 10 10.10.10.50
```

### Enumerate User Accounts

```bash
snmpwalk -c public -v1 10.10.10.50 1.3.6.1.4.1.77.1.2.25
```

### Enumerate Running Processes

```bash
snmpwalk -c public -v1 10.10.10.50 1.3.6.1.2.1.25.4.2.1.2
```

### Enumerate Installed Software

```bash
snmpwalk -c public -v1 10.10.10.50 1.3.6.1.2.1.25.6.3.1.2
```

### Enumerate Listening TCP Ports

```bash
snmpwalk -c public -v1 10.10.10.50 1.3.6.1.2.1.6.13.1.3
```


## Dangerous Settings

Some dangerous settings that the administrator can make with SNMP are:

|**Settings**|**Description**|
|---|---|
|`rwuser noauth`|Provides access to the full OID tree without authentication.|
|`rwcommunity <community string> <IPv4 address>`|Provides access to the full OID tree regardless of where the requests were sent from.|
|`rwcommunity6 <community string> <IPv6 address>`|Same access as with `rwcommunity` with the difference of using IPv6.|
# Footprinting

For footprinting SNMP, we can use tools like `snmpwalk`, `onesixtyone`, and `braa`. `Snmpwalk` is used to query the OIDs with their information. `Onesixtyone` can be used to brute-force the names of the community strings since they can be named arbitrarily by the administrator. Since these community strings can be bound to any source, identifying the existing community strings can take quite some time.


You have to search for community name for diggin::
#### OneSixtyOne
```shell-session
$ sudo apt install onesixtyone
$ onesixtyone -c /opt/useful/SecLists/Discovery/SNMP/snmp.txt 10.129.14.128
```
#### SNMPwalk
```shell-session
$ snmpwalk -v2c -c communityname 10.129.14.128
```
#### Braa
```shell-session
$ sudo apt install braa
$ braa <community string>@<IP>:.1.3.6.*   # Syntax
$ braa public@10.129.14.128:.1.3.6.*
```
## 💡 Key Takeaways

- **SNMPv1** is vulnerable due to plaintext community strings (e.g., `public`).
    
- Use **nmap** or **onesixtyone** to identify SNMP endpoints and valid strings.
    
- Use **snmpwalk** to extract data such as users, processes, ports, and software.
    
- Extracted data may reveal:
    
    - Vulnerable services or versions
        
    - Internal user accounts
        
    - Potential social engineering targets
        
- Always anonymize and sanitize outputs in documentation/lab reports.
