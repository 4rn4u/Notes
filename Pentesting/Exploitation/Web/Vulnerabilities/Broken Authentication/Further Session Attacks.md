### Further Session Attacks

Beyond brute-forcing and guessing session tokens, there are additional attack vectors that exploit flaws in the handling of session tokens within web applications. Here we discuss **Session Fixation** and **Improper Session Timeout** vulnerabilities, which can allow attackers to hijack or indefinitely control user sessions.

#### Session Fixation

**Session Fixation** is an attack where an attacker tricks a victim into using a session token that the attacker knows in advance. If the web application does not assign a fresh session token upon login, the attacker can effectively take over the victim’s session after they authenticate.

**Example Attack Flow**:

1. **Obtaining a Session Token**: The attacker authenticates to the application and receives a session token, e.g., `a1b2c3d4e5f6`.
2. **Session Fixation Setup**: The attacker logs out but retains the token. They then send a crafted link to the victim, such as:
   ```
   http://vulnerable.htb/?sid=a1b2c3d4e5f6
   ```
3. **Victim’s Interaction**: When the victim clicks the link, the application assigns the `sid` parameter’s value as their session cookie:
   ```http
   HTTP/1.1 200 OK
   Set-Cookie: session=a1b2c3d4e5f6
   ```
4. **Victim’s Authentication**: The victim logs in, and because the application doesn’t issue a new session token, they continue using the attacker’s session token.
5. **Session Hijacking**: The attacker, knowing the session token `a1b2c3d4e5f6`, can access the victim’s session.

To prevent **Session Fixation**:

- Web applications should always assign a **new, random session token** after a successful login, ensuring that previous tokens cannot be reused.

#### Improper Session Timeout

**Improper Session Timeout** vulnerabilities arise when a web application fails to set an appropriate expiration period for session tokens. Without a timeout, a session token remains valid indefinitely, allowing attackers to reuse hijacked tokens for extended periods.

**Example**:

If a session token is not set to expire, a hijacked session can be used indefinitely by an attacker. This is especially risky for applications handling sensitive information, where prolonged session validity increases exposure to unauthorized access.

**Setting Appropriate Session Timeouts**:

- The ideal **session timeout** depends on the application’s context and sensitivity. For instance:
  - **Highly Sensitive Applications** (e.g., healthcare): Short timeouts in the range of minutes.
  - **Less Sensitive Applications** (e.g., social media): Longer timeouts, potentially several hours.

By implementing new session tokens after login and enforcing session timeouts, web applications can significantly reduce risks associated with session fixation and prolonged session validity, helping to safeguard user sessions.