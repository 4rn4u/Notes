### Authentication Bypass via Direct Access

In cases of flawed authentication, an **authentication bypass** vulnerability can allow attackers to access restricted resources directly, bypassing the login process entirely.

#### Direct Access Vulnerability

A common, though rare, vulnerability arises when an attacker requests a protected resource directly without authentication, and the application fails to verify the user’s authentication status. If the application only checks for authentication on the login page and not on the restricted resource itself, attackers can access sensitive information by directly visiting the endpoint.

For example, consider an application that redirects authenticated users to `/admin.php`, a page meant to be accessible only after login. If the application does not check for an active session when accessing `/admin.php`, an unauthenticated attacker can access this page simply by visiting the URL.

#### Example Scenario: PHP Authentication Check

Let’s assume the following PHP code is used to verify authentication:

```php
if(!$_SESSION['active']) {
    header("Location: index.php");
}
```

This code redirects unauthenticated users to `index.php`. However, it does not stop execution, meaning that the page’s protected content is still sent in the response body. While the browser would follow the redirect to the login page, the page content remains in the response, making it accessible.

#### Exploiting the Vulnerability with Burp Suite

1. **Intercept the Response**: Use a tool like Burp Suite to intercept the response from the `/admin.php` endpoint.
2. **Modify the Status Code**: Change the status code from `302 Found` to `200 OK`. This prevents the browser from following the redirect and instead displays the protected content.

By modifying the status code, the browser displays the restricted content without requiring authentication.

#### Preventing Direct Access Vulnerabilities

To properly secure the authentication check, the application must immediately stop execution after issuing a redirect. For example:

```php
if(!$_SESSION['active']) {
    header("Location: index.php");
    exit;
}
```

The `exit;` command ensures that the script halts execution, preventing the sensitive content from being sent in the response. Regular code reviews and testing can help identify and prevent this vulnerability in web applications.