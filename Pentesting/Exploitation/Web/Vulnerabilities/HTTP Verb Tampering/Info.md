### Introduction to HTTP Verb Tampering

**HTTP Verb Tampering** is an attack that takes advantage of insecure handling of HTTP methods (verbs) by web applications and servers. HTTP supports multiple request methods, such as GET, POST, HEAD, PUT, DELETE, OPTIONS, and PATCH, which can control different functionalities. If the web server or application is configured to handle certain HTTP methods incorrectly, attackers may exploit these methods to bypass security controls, access unauthorized resources, or even modify server data.

#### How HTTP Verb Tampering Works

Web applications are typically configured to accept the most common HTTP methodsâ€”GET and POST. However, some servers may accept additional methods like PUT, DELETE, and PATCH, which can carry significant security implications. 

For example, if a server does not restrict the methods it accepts, an attacker might use the PUT or DELETE method to modify or delete server resources. Such a configuration oversight allows attackers to abuse lesser-used HTTP methods to bypass restrictions or gain unauthorized access.

#### Common HTTP Verbs Exploited in Attacks

- **HEAD**: Returns headers without a response body, often similar to GET.
- **PUT**: Writes the request payload to a specific location, allowing potential file uploads.
- **DELETE**: Deletes the specified resource.
- **OPTIONS**: Lists the HTTP methods allowed by the server.
- **PATCH**: Modifies part of a resource at the specified location.

If these methods are not properly controlled, attackers can use them to tamper with server configurations or bypass restrictions set for GET and POST.

#### Types of HTTP Verb Tampering Vulnerabilities

1. **Insecure Configurations**:
   Insecure configurations are a common cause of HTTP Verb Tampering. For example, a server may be configured to enforce authentication only on GET and POST requests, leaving other methods unprotected:

   ```xml
   <Limit GET POST>
       Require valid-user
   </Limit>
   ```

   In this setup, an attacker could use a different HTTP method, such as HEAD, to bypass authentication and access restricted content.

2. **Insecure Coding**:
   Poor coding practices can also introduce HTTP Verb Tampering vulnerabilities. For instance, suppose a developer applies input sanitization only on GET requests to mitigate a SQL injection vulnerability, but the code executes a query using parameters from both GET and POST requests:

   ```php
   $pattern = "/^[A-Za-z\s]+$/";
   if(preg_match($pattern, $_GET["code"])) {
       $query = "Select * from ports where port_code like '%" . $_REQUEST["code"] . "%'";
   }
   ```

   In this example, the filter is applied to GET parameters only, while the query uses `$_REQUEST`, which includes both GET and POST data. An attacker could send a POST request that bypasses the sanitization filter, leading to a successful SQL injection.

#### Preventing HTTP Verb Tampering

1. **Strictly Control Allowed HTTP Methods**: Configure the server to accept only the required methods (e.g., GET and POST) and block all others.
2. **Uniform Input Handling**: Apply input validation consistently across all HTTP methods to prevent bypass through alternate verbs.
3. **Secure Coding Practices**: Ensure that security checks are applied consistently, regardless of the HTTP method used, and use server configuration best practices to secure web applications.

Through these measures, you can help prevent HTTP Verb Tampering and ensure that server configurations and coding practices align to protect web applications.