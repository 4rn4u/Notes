### **üìÇ File Upload Vulnerabilities

File upload functionality is common in modern web applications, but if not properly secured, it can introduce serious vulnerabilities. These vulnerabilities can be exploited to gain unauthorized access, upload malicious content, or execute arbitrary code on the server.

This unit focuses on understanding, identifying, and exploiting file upload vulnerabilities, which generally fall into **three main categories**:

---

#### **1. Direct Code Execution**

This occurs when an attacker is able to upload a file that the server can **execute**, such as a `.php` script on a PHP-enabled server. Once uploaded, the attacker can access the file via a browser or tool like `curl`, triggering **remote code execution**.

Example:  
Upload `shell.php`, then visit `http://target.com/uploads/shell.php`.

---

#### **2. Chained Exploits**

Sometimes file upload vulnerabilities must be **combined with other weaknesses** to be effective. For example:

- **Directory Traversal** can allow overwriting important files like `authorized_keys`.
- **XXE** or **XSS** can be embedded in uploadable file types like `.svg`.

These chained attacks let attackers bypass restrictions or gain deeper system access.

---

#### **3. Social Engineering / User Interaction**

In this case, the exploit depends on a **user opening the uploaded file**. For instance, a `.docx` file containing **malicious macros** may be uploaded through a job application form. When opened by HR, the macro runs and compromises their system.

While important, this unit focuses primarily on the **first two categories** that don‚Äôt rely on user interaction.

---

### üîç Key Takeaways:

- Not all file upload vulnerabilities are obvious‚Äîsome require creative chaining with other bugs.
- File type checks and upload directory permissions are critical for defense.
- Always test upload functionalities carefully, considering different file types, content, and paths.