### Introduction to XSLT Injection

**eXtensible Stylesheet Language Transformation (XSLT)** is a language used to transform XML documents. By using XSLT, XML data can be restructured or reformatted, enabling dynamic content generation. For example, XSLT can filter, sort, or format XML nodes.

### How XSLT Works

XSLT documents are structured similarly to XML but use specific **XSL elements** to define transformations. These elements are prefixed with `xsl:` and control how data from the XML document is processed. 

Letâ€™s consider a sample XML document:

```xml
<fruits>
    <fruit>
        <name>Apple</name>
        <color>Red</color>
        <size>Medium</size>
    </fruit>
    <fruit>
        <name>Banana</name>
        <color>Yellow</color>
        <size>Medium</size>
    </fruit>
</fruits>
```

An XSLT document might be used to select and display data from this XML, such as the name and color of each fruit:

```xslt
<xsl:template match="/fruits">
    Here are all the fruits:
    <xsl:for-each select="fruit">
        <xsl:value-of select="name"/> (<xsl:value-of select="color"/>)
    </xsl:for-each>
</xsl:template>
```

In this example, the `xsl:for-each` directive loops over each `<fruit>` node, and `xsl:value-of` extracts specific values (e.g., `<name>` and `<color>`). When processed, it produces output like:

```
Here are all the fruits:
    Apple (Red)
    Banana (Yellow)
```

#### Advanced XSL Elements

- **`xsl:sort`**: Sorts elements within a loop.
- **`xsl:if`**: Filters elements based on conditions.

For example, using these elements, we can display only medium-sized fruits, sorted by color:

```xslt
<xsl:for-each select="fruit">
    <xsl:sort select="color" order="descending" />
    <xsl:if test="size = 'Medium'">
        <xsl:value-of select="name"/> (<xsl:value-of select="color"/>)
    </xsl:if>
</xsl:for-each>
```

This results in:
```
Here are all fruits of medium size ordered by their color:
    Banana (Yellow)
    Apple (Red)
```

### What is XSLT Injection?

**XSLT Injection** occurs when user input is improperly inserted into XSLT data before processing. If user-provided data is embedded directly into the XSLT document, an attacker can inject malicious XSL elements. These injected elements are then executed by the XSLT processor, which could lead to unauthorized access or manipulation of data.

To prevent XSLT injection, applications should ensure that user input is strictly separated from XSL templates and only incorporated as non-executable data during processing.