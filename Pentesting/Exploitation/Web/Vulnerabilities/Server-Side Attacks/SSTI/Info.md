### Introduction to Server-Side Template Injection (SSTI)

**Server-Side Template Injection (SSTI)** vulnerabilities arise when an attacker is able to inject code into a server-rendered template. If a web application doesnâ€™t securely handle user input, an attacker could potentially inject malicious code into the template. This code would be executed on the server during the rendering process, which could lead to severe outcomes, including full server compromise.

### How SSTI Occurs

Templates rely on dynamic values passed to a template engine, often sourced from user input. Typically, when user input is safely provided as a separate **value** to the rendering function, the template engine simply replaces placeholders with these values, without executing any code within the values themselves. However, SSTI vulnerabilities occur when attackers can manipulate the **template** itself, as opposed to just the values.

### Common Scenarios Leading to SSTI

1. **Direct Template Control**: If an attacker can control part of the template string directly, any injected code within the template may be executed by the server. For instance, an application vulnerable to SSTI might incorrectly insert user input directly into the template string before rendering.

2. **Repeated Rendering**: Another case involves rendering the same template multiple times. If user input is injected into the output of an initial render and treated as part of the template in subsequent renders, this input might become executable code.

3. **Editable Templates**: Applications allowing users to modify or create templates inherently risk SSTI. If an attacker can insert code into a template that the server later renders, they may be able to execute code on the server.

Insecure handling of templates and user input makes SSTI vulnerabilities possible, emphasizing the need for strict separation of templates and data inputs during rendering to ensure security.