| Ref | Risk | Issue Description & Implications                                                                                                                                                                                                                                                                                                     | Recommendations                                                                                                                                                                                   |
|-----|------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1   | H    | **Inadequate Account, Password, and Privilege Management**<br><br>During a post-incident analysis of **122,624 user profiles**, the following critical findings emerged:<br>• **722 accounts** had settings that never force password expiration.<br>• **23,142 accounts** were completely unused, with no recorded login history.<br>• **6 accounts** were assigned to the Domain Administrators group.<br>• **968 accounts** were still relying on default initial passwords.<br><br>Weak governance of these areas greatly increases the risk of unauthorized access, privilege escalation, and prolonged exploitation by malicious actors. | - Enforce a **strict password policy** (complexity, history, and expiration).<br>- Implement **mandatory password resets** for any accounts currently using weak or default passwords.<br>- Ensure **automatic expiration** for all user accounts.<br>- Remove or disable **unnecessary and outdated accounts** on a regular basis. |
| 2   | H    | **Excessive Data Leakage via Anonymous SMB Sessions**<br><br>An unauthenticated SMB connection allowed retrieval of sensitive information, enabling the escalation of privileges described in Appendix E.9. Uncontrolled SMB sharing exposes system details that intruders can use to pivot deeper into the network, increasing the likelihood of data breaches and internal compromise. | - Restrict access to **TCP ports 139 and 445** to authorized roles only.<br>- Disable anonymous enumeration of accounts (via **Local Security Policy > Local Policies > Security Options**).<br>- Implement strict access controls to limit lateral movement within the network.                                        |
| 3   | M    | **Potential for Malicious JavaScript Injection (Reflected XSS)**<br><br>Attackers can embed harmful JavaScript code in user-controlled inputs, which the web application then reflects back to unsuspecting users. When the script executes, it can lead to unauthorized actions, credential harvesting, and reputational damage, especially if leaked data or fines are involved. <br><br>Testing showed that when a login attempt fails, the application echoes the username back to the user’s browser without proper sanitization. A working proof-of-concept can be found in Appendix E, demonstrating how attackers could execute scripts within a victim’s session. | - Treat **all user inputs** as untrusted and implement strict sanitization.<br>- Encode or escape any user-provided values before rendering them in HTML output.<br>- Omit or generalize **failed login messages** so that sensitive details (like the username) aren’t displayed back to the user.                           |
