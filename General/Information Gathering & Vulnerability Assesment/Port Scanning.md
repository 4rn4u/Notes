# Port Scanning

--------------------------------------------------------------------

> ping **ip**

--------------------------------------------------------------------

# Port States

## State Descriptions

- **open**
  - This indicates that the connection to the scanned port has been established. These connections can be TCP connections, UDP datagrams as well as SCTP associations.

- **closed**
  - When the port is shown as closed, the TCP protocol indicates that the packet we received back contains an RST flag. This scanning method can also be used to determine if our target is alive or not.

- **filtered**
  - Nmap cannot correctly identify whether the scanned port is open or closed because either no response is returned from the target for the port or we get an error code from the target.

- **unfiltered**
  - This state of a port only occurs during the TCP-ACK scan and means that the port is accessible, but it cannot be determined whether it is open or closed.

- **open|filtered**
  - If we do not get a response for a specific port, Nmap will set it to that state. This indicates that a firewall or packet filter may protect the port.

- **closed|filtered**
  - This state only occurs in the IP ID idle scans and indicates that it was impossible to determine if the scanned port is closed or filtered by a firewall.

--------------------------------------------------------------------

# Scan Types

**-sS**: also known as a SYN scan, is a stealthy and efficient method that sends SYN packets to determine if a port is open (SYN-ACK response) or closed (RST response) without completing the TCP handshake.

**-sT**: or TCP connect scan, establishes a full TCP connection with the target port, making it less stealthy but reliable for determining if a port is open (successful connection) or closed (connection refused). (Three way handshake)




--------------------------------------------------------------------
# Examples

**NMAP PORTS:**
```shell-session
$ nmap -Pn (ip)

$ nmap -Pn -sCV -0 -v ()

$ nmap -iL ips

$ nmap -iL ips -sV -0

$ nmap -T4 -PA -sC -sV -p 1-10000 0.0.0.0

$ nmap -sV -sC -p 445 0.0.0.0
```
Trace Packets:
```shell-session
$ sudo nmap 10.129.2.28 -p 21 --packet-trace -Pn -n --disable-arp-ping
```
Connect Scan:
```shell-session
$ sudo nmap 10.129.2.28 -p 443 --packet-trace --disable-arp-ping -Pn -n --reason -sT 
```
Filtered:
```shell-session
$ sudo nmap 10.129.2.28 -p 139 --packet-trace -n --disable-arp-ping -Pn
```
UDP: 
```shell-session
$ sudo nmap 10.129.2.28 -F -sU
```
```shell-session
$ sudo nmap 10.129.2.28 -sU -Pn -n --disable-arp-ping --packet-trace -p 137 --reason 
```

Version Scan:
```shell-session
$ sudo nmap 10.129.2.28 -Pn -n --disable-arp-ping --packet-trace -p 445 --reason  -sV
```

**If type3 recieved --> closed**

## Cheatsheet

> -p- -> Scan all ports

> --top-ports=10 
 
> --packet-trace -> Shows all packets sent and received

> --disable-arp-ping -> Disables ARP ping>

> --reason -> Displays the reason for specific result

> -n -> Disables DNS resolution

>-Pn -> Disables ICMP Echo requests

> -F -> Scans top 100 ports

> -sU -> Performs a UDP scan

> -p 100 -> Scans only specified port

>-sV -> Service Scan

> Agressive scan: nmap -A
--------------------------------------------------------------------


# Output

> Normal Format: -oN target   --> **(saved in .nmap)**

> Grepable Format : -oG target  --> **(saved in .gnmap)**

> XML format: -oX target  --> **(saved in .xml)**

### With XML output we can create HTML reports for documentation:

```shell-session
$ xsltproc target.xml -o target.html
```

--------------------------------------------------------------------