# Windows Remote Management (WinRM)

Windows Remote Management (WinRM) is a simple, integrated remote management protocol in Windows, based on the command line. WinRM uses the Simple Object Access Protocol (SOAP) to establish connections to remote hosts and their applications. Starting with Windows 10, WinRM must be explicitly enabled and configured.

## Communication Ports

WinRM communicates over TCP ports 5985 and 5986, with port 5986 using HTTPS. Previously, ports 80 and 443 were used for this purpose, but due to security concerns, ports 5985 and 5986 are now preferred.

## Windows Remote Shell (WinRS)

Windows Remote Shell (WinRS) is a component of WinRM that allows the execution of arbitrary commands on a remote system. WinRS is included by default on Windows 7 and later versions. This makes it possible to execute remote commands on another server using WinRM.

## Usage and Configuration

WinRM is essential for services like remote PowerShell sessions and event log merging. It is enabled by default starting with Windows Server 2012. For older server versions and clients, WinRM must be configured manually, and the necessary firewall exceptions must be created.

## Key Points

- **Protocol**: WinRM uses SOAP for establishing connections.
- **Ports**: Communicates over TCP ports 5985 (HTTP) and 5986 (HTTPS).
- **WinRS**: Allows execution of commands on remote systems.
- **Default Configuration**: Enabled by default on Windows Server 2012 and later, but requires configuration on older versions.

# Footprinting
#### Nmap WinRM

```shell-session
$ nmap -sV -sC 10.129.201.248 -p5985,5986 --disable-arp-ping -n
```

To determine if one or more remote servers can be accessed via WinRM, we can use PowerShell or a Linux-based tool. In PowerShell, the `Test-WsMan` cmdlet is used to check connectivity by passing the target host's name. For Linux-based environments, `evil-winrm` is a penetration testing tool that interacts with WinRM to verify connectivity and manage remote servers.

```shell-session
$ evil-winrm -i 10.129.201.248 -u Cry0l1t3 -p P455w0rD!
```