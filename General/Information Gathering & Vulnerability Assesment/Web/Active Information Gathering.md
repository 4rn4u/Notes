### Active Reconnaissance Techniques Overview

Active reconnaissance involves direct interaction with the target system to gather valuable information. Here’s a detailed look at various techniques, their descriptions, examples, tools, and associated risks of detection:

#### Port Scanning

- **Description**: Identifying open ports and services running on the target.
- **Example**: Using Nmap to scan a web server for open ports like 80 (HTTP) and 443 (HTTPS).
- **Tools**: Nmap, Masscan, Unicornscan
- **Risk of Detection**: **High** - Direct interaction with the target can trigger intrusion detection systems (IDS) and firewalls.

#### Vulnerability Scanning

- **Description**: Probing the target for known vulnerabilities, such as outdated software or misconfigurations.
- **Example**: Running Nessus against a web application to check for SQL injection flaws or cross-site scripting (XSS) vulnerabilities.
- **Tools**: Nessus, OpenVAS, Nikto
- **Risk of Detection**: **High** - Vulnerability scanners send exploit payloads that security solutions can detect.

#### Network Mapping

- **Description**: Mapping the target's network topology, including connected devices and their relationships.
- **Example**: Using traceroute to determine the path packets take to reach the target server, revealing potential network hops and infrastructure.
- **Tools**: Traceroute, Nmap
- **Risk of Detection**: **Medium to High** - Excessive or unusual network traffic can raise suspicion.

#### Banner Grabbing

- **Description**: Retrieving information from banners displayed by services running on the target.
- **Example**: Connecting to a web server on port 80 and examining the HTTP banner to identify the web server software and version.
- **Tools**: Netcat, curl
- **Risk of Detection**: **Low** - Banner grabbing typically involves minimal interaction but can still be logged.

#### OS Fingerprinting

- **Description**: Identifying the operating system running on the target.
- **Example**: Using Nmap's OS detection capabilities (`-O`) to determine if the target is running Windows, Linux, or another OS.
- **Tools**: Nmap, Xprobe2
- **Risk of Detection**: **Low** - OS fingerprinting is usually passive, but some advanced techniques can be detected.

#### Service Enumeration

- **Description**: Determining the specific versions of services running on open ports.
- **Example**: Using Nmap's service version detection (`-sV`) to determine if a web server is running Apache 2.4.50 or Nginx 1.18.0.
- **Tools**: Nmap
- **Risk of Detection**: **Low** - Similar to banner grabbing, service enumeration can be logged but is less likely to trigger alerts.

#### Web Spidering

- **Description**: Crawling the target website to identify web pages, directories, and files.
- **Example**: Running a web crawler like Burp Suite Spider or OWASP ZAP Spider to map out the structure of a website and discover hidden resources.
- **Tools**: Burp Suite Spider, OWASP ZAP Spider, Scrapy (customizable)
- **Risk of Detection**: **Low to Medium** - Can be detected if the crawler's behavior is not carefully configured to mimic legitimate traffic.

--------------------------------------------------------------------

## Active subdomain enumeration:
### DNS Enumeration Tools

| Tool            | Description                                                                                                                     |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| **dnsenum**     | Comprehensive DNS enumeration tool that supports dictionary and brute-force attacks for discovering subdomains.                 |
| **fierce**      | User-friendly tool for recursive subdomain discovery, featuring wildcard detection and an easy-to-use interface.                |
| **dnsrecon**    | Versatile tool that combines multiple DNS reconnaissance techniques and offers customizable output formats.                     |
| **amass**       | Actively maintained tool focused on subdomain discovery, known for its integration with other tools and extensive data sources. |
| **assetfinder** | Simple yet effective tool for finding subdomains using various techniques, ideal for quick and lightweight scans.               |
| **puredns**     | Powerful and flexible DNS brute-forcing tool, capable of resolving and filtering results effectively.                           |

```bash
$ dnsenum --enum inlanefreight.com -f /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -r
```

##  Zone Transfers

```shell-session
$ dig axfr @nsztm1.digi.ninja zonetransfer.me
```
```shell-session
$ dig axfr zonetransfer.me @0.0.0.0
```


# Virtual Hosts:
## Types of Virtual Hosting

## Name-Based Virtual Hosting
- **Uses**: HTTP Host header to differentiate websites.
- **Pros**: Cost-effective, easy setup, no extra IPs needed.
- **Cons**: Requires server support, limitations with SSL/TLS.

## IP-Based Virtual Hosting
- **Uses**: Unique IP for each website.
- **Pros**: Protocol-agnostic, better isolation.
- **Cons**: Requires multiple IPs, less scalable.

## Port-Based Virtual Hosting
- **Uses**: Different ports for different websites on the same IP.
- **Pros**: Useful when IPs are limited.
- **Cons**: Less common, requires specifying port in URL.
## Virtual Host Discovery Tools

While manual analysis of `HTTP headers` and reverse `DNS lookups` can be effective, specialised `virtual host discovery tools` automate and streamline the process, making it more efficient and comprehensive. These tools employ various techniques to probe the target server and uncover potential `virtual hosts`.

Several tools are available to aid in the discovery of virtual hosts:

| Tool                                                 | Description                                                                                                      | Features                                                        |
| ---------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- |
| [gobuster](https://github.com/OJ/gobuster)           | A multi-purpose tool often used for directory/file brute-forcing, but also effective for virtual host discovery. | Fast, supports multiple HTTP methods, can use custom wordlists. |
| [Feroxbuster](https://github.com/epi052/feroxbuster) | Similar to Gobuster, but with a Rust-based implementation, known for its speed and flexibility.                  | Supports recursion, wildcard discovery, and various filters.    |
| [ffuf](https://github.com/ffuf/ffuf)                 | Another fast web fuzzer that can be used for virtual host discovery by fuzzing the `Host` header.                |                                                                 |
|                                                      |                                                                                                                  |                                                                 |

```shell-session
$ gobuster vhost -u http://<target_IP_address> -w <wordlist_file> --append-domain
```
- The `-u` flag specifies the target URL (replace `<target_IP_address>` with the actual IP).
- The `-w` flag specifies the wordlist file (replace `<wordlist_file>` with the path to your wordlist).
- The `--append-domain` flag appends the base domain to each word in the wordlist.
- Consider using the `-t` flag to increase the number of threads for faster scanning.
- The `-k` flag can ignore SSL/TLS certificate errors.
- You can use the `-o` flag to save the output to a file for later analysis.

```shell-session
$ gobuster vhost -u http://inlanefreight.htb:81 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain
```

$ echo "{GOBUSTER}.inlanefreight.htb" > pattern
```shell-session
$ gobuster vhost -u http://<IP>:<PORT> -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -p pattern -t 20
```

# Searching CT Logs

Two popular tools are available for searching Certificate Transparency (CT) logs:

| Tool    | Key Features | Use Cases | Pros | Cons |
|---------|--------------|-----------|------|------|
| **crt.sh** | User-friendly web interface, simple search by domain, displays certificate details, SAN entries. | Quick and easy searches, identifying subdomains, checking certificate issuance history. | Free, easy to use, no registration required. | Limited filtering and analysis options. |
| **Censys** | Powerful search engine for internet-connected devices, advanced filtering by domain, IP, certificate attributes. | In-depth analysis of certificates, identifying misconfigurations, finding related certificates and hosts. | Extensive data and filtering options, API access. | Requires registration (free tier available). |
```shell-session
$ curl -s "https://crt.sh/?q=facebook.com&output=json" | jq -r '.[] | select(.name_value | contains("dev")) | .name_value' | sort -u
```
- `curl -s "https://crt.sh/?q=facebook.com&output=json"`: This command fetches the JSON output from crt.sh for certificates matching the domain `facebook.com`.
- `jq -r '.[] | select(.name_value | contains("dev")) | .name_value'`: This part filters the JSON results, selecting only entries where the `name_value` field (which contains the domain or subdomain) includes the string "`dev.`" The `-r` flag tells `jq` to output raw strings.
- `sort -u`: This sorts the results alphabetically and removes duplicates.