### Anti-CSRF Token Bypass

Anti-CSRF tokens are commonly used to protect against automated tools by requiring a valid token for each HTTP request, ensuring the user has visited and interacted with the page. While these tokens were initially designed to prevent malicious actions via unwanted links, they also make automation, such as SQL injection, more challenging.

SQLMap offers the `--csrf-token` option to help bypass this protection. By specifying the token parameter name, SQLMap automatically parses the response to retrieve fresh token values for subsequent requests.

Even if the token's name isn't explicitly provided, SQLMap can detect common token-related parameters (e.g., csrf, xsrf, token) and prompt the user to update the value in future requests.

```shell-session
$ sqlmap -u "http://www.example.com/" --data="id=1&csrf-token=WfF1szMUHhiokx9AHFply5L2xAOfjRkE" --csrf-token="csrf-token"
```
## Unique Value Bypass
```shell-session
$ sqlmap -u "http://www.example.com/?id=1&rp=29125" --randomize=rp --batch -v 5 | grep URI
```
## Calculated Parameter Bypass
```shell-session
$ sqlmap -u "http://www.example.com/?id=1&h=c4ca4238a0b923820dcc509a6f75849b" --eval="import hashlib; h=hashlib.md5(id).hexdigest()" --batch -v 5 | grep URI
```
### IP Address Concealing

To hide your IP address or bypass IP blacklisting, you can use a proxy with the `--proxy` option. Alternatively, if you have a list of proxies, use `--proxy-file` to let SQLMap cycle through them, skipping blacklisted IPs.

Another option is using the Tor network for anonymization. When installed locally, SQLMap automatically detects the SOCKS4 proxy for Tor on ports 9050 or 9150 using the `--tor` option. To ensure proper use of Tor, the `--check-tor` switch checks if the connection is routed through Tor.

### WAF Bypass

SQLMap initially tests for the presence of a Web Application Firewall (WAF) by sending a payload with a non-existent parameter. A significant response difference suggests WAF protection. If detected, SQLMap uses the `identYwaf` library to identify the WAF. To reduce noise during tests, the `--skip-waf` option bypasses this check.

### User-Agent Blacklisting Bypass

If SQLMap encounters issues early (e.g., 5XX errors), it could be due to user-agent blacklisting. The `--random-agent` switch randomizes the user-agent to bypass such restrictions.

### Tamper Scripts

Tamper scripts modify SQLMap's requests to bypass WAFs or intrusion prevention systems. For example, they can replace the `>` operator with `NOT BETWEEN 0 AND #` or `=` with `BETWEEN # AND #`. These scripts can be chained using the `--tamper` option, which runs them in a predefined priority order to avoid conflicts.

Some popular tamper scripts include:

- **0eunion**: Replaces instances of `UNION` with `e0UNION`
- **base64encode**: Encodes the payload in Base64
- **space2comment**: Replaces spaces with comments
- **randomcase**: Randomizes the case of SQL keywords

For a full list of tamper scripts, use the `--list-tampers` option. You can also create custom tamper scripts for specialized attacks.

### Miscellaneous Bypasses

Additional bypass techniques include:

- **Chunked Transfer Encoding**: Use `--chunked` to split POST request bodies into chunks, allowing blacklisted SQL keywords to pass unnoticed.
- **HTTP Parameter Pollution (HPP)**: Splits payloads between repeated parameters, which are concatenated by the server (if supported).

```shell-session
$ sqlmap -u "http://www.example.com/?id=1" --file-write "shell.php" --file-dest "/var/www/html/shell.php"
```