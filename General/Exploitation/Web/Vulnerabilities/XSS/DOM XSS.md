The third and final type of XSS is another `Non-Persistent` type called `DOM-based XSS`. While `reflected XSS` sends the input data to the back-end server through HTTP requests, DOM XSS is completely processed on the client-side through JavaScript. DOM XSS occurs when JavaScript is used to change the page source through the `Document Object Model (DOM)`.
## Source & Sink

To understand the nature of DOM-based XSS vulnerabilities, it's essential to grasp the concepts of **Source** and **Sink**.

- **Source**: The JavaScript object that accepts user input. This can come from various input parameters like a URL parameter or an input field.
  
- **Sink**: The function that writes this user input to a DOM object on the page. If the Sink function does not properly sanitize the input, it can lead to an XSS vulnerability.

### Common Sink Functions

Here are some frequently used JavaScript functions that write user input to the DOM:

- `document.write()`
- `DOM.innerHTML`
- `DOM.outerHTML`

Additionally, some jQuery functions also write to the DOM:

- `add()`
- `after()`
- `append()`

If a Sink function writes the exact input without any sanitization (such as with the functions listed above), and no other sanitization is applied, the page becomes vulnerable to XSS attacks.

### Example: To-Do Application

In the source code of the To-Do web application, the **Source** of the input is taken from the `task` parameter in the URL:

```javascript
var pos = document.URL.indexOf("task=");
var task = document.URL.substring(pos + 5, document.URL.length);
```
Next, the page uses the innerHTML function to write the task variable into the todo DOM element:
```javascript
document.getElementById("todo").innerHTML = "<b>Next Task:</b> " + decodeURIComponent(task);
```

## DOM Attacks

If we try the XSS payload we have been using previously, we will see that it will not execute. This is because the `innerHTML` function does not allow the use of the `<script>` tags within it as a security feature. Still, there are many other XSS payloads we use that do not contain `<script>` tags, like the following XSS payload:

```html
<img src="" onerror=alert(window.origin)>
```


